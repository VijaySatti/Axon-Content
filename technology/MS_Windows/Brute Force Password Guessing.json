{
  "title": "Brute Force Password Guessing",
  "version": 3,
  "description": "This rule will trigger when 10 or more failed authentication attempts are witnessed in 5 minutes from the same origin account and host",
  "observationPipeline": {
    "pattern": {
      "operations": [
        {
          "touched": true,
          "blockType": "COUNT_THRESHOLD_OBSERVED",
          "operationType": "WHERE_PATTERN_OPERATION",
          "isOutOfBoxRule": false,
          "ruleElementKey": "9b89aab8-89ab-4cde-b012-318c7d992fc4",
          "countThresholdObserved": {
            "filter": "general_information.common_event_name = \"Authentication Failure\"",
            "threshold": 10,
            "groupByFields": [
              "origin.account.name",
              "target.host.name",
              "object.process.name"
            ],
            "windowSeconds": 300
          }
        }
      ],
      "afterMatchSkipStrategy": "SKIP_PAST_LAST_EVENT"
    },
    "commonEvents": [
      "dfeb1ad8-0b54-4759-a07a-4fc7dd9a4fc4",
      "348a37e6-590e-4767-baae-a5c3951391ae"
    ],
    "metadataFields": {
      "threat.severity": "high",
      "threat.mitre_tactic": "TA0006:Credential Access",
      "threat.mitre_technique": "T1110.001:Brute Force - Password Guessing"
    },
    "suppressionConfig": {
      "enabled": false,
      "groupByFields": [],
      "windowSeconds": 3600
    }
  }
}